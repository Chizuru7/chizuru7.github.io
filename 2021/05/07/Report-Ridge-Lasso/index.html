<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>Insight Ridge and Lasso - Chizuru7&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Chizuru7&#039;s Blog"><meta name="msapplication-TileImage" content="https://i.loli.net/2021/04/03/wDoVkMUd9LFYgqA.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Chizuru7&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Ridge and Lasso Regressions are expansions of OLS. The key difference is that they restrict the coefficients in loss function. You may wonder why we should implement constraints and this report tries"><meta property="og:type" content="blog"><meta property="og:title" content="Insight Ridge and Lasso"><meta property="og:url" content="http://example.com/2021/05/07/Report-Ridge-Lasso/"><meta property="og:site_name" content="Chizuru7&#039;s Blog"><meta property="og:description" content="Ridge and Lasso Regressions are expansions of OLS. The key difference is that they restrict the coefficients in loss function. You may wonder why we should implement constraints and this report tries"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2021-05-07T11:06:03.000Z"><meta property="article:modified_time" content="2021-05-09T07:49:08.710Z"><meta property="article:author" content="Junwei Lin"><meta property="article:tag" content="微观计量"><meta property="twitter:card" content="summary"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2021/05/07/Report-Ridge-Lasso/"},"headline":"Chizuru7's Blog","image":[],"datePublished":"2021-05-07T11:06:03.000Z","dateModified":"2021-05-09T07:49:08.710Z","author":{"@type":"Person","name":"Junwei Lin"},"description":"Ridge and Lasso Regressions are expansions of OLS. The key difference is that they restrict the coefficients in loss function. You may wonder why we should implement constraints and this report tries"}</script><link rel="canonical" href="http://example.com/2021/05/07/Report-Ridge-Lasso/"><link rel="icon" href="https://i.loli.net/2021/04/03/wDoVkMUd9LFYgqA.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.12.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="https://i.loli.net/2021/04/03/wDoVkMUd9LFYgqA.png" alt="Chizuru7&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Chizuru7"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="目录" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-05-07T11:06:03.000Z" title="2021/5/7 下午7:06:03">2021-05-07</time>发表</span><span class="level-item"><time dateTime="2021-05-09T07:49:08.710Z" title="2021/5/9 下午3:49:08">2021-05-09</time>更新</span><span class="level-item">4 分钟读完 (大约613个字)</span></div></div><h1 class="title is-3 is-size-4-mobile">Insight Ridge and Lasso</h1><div class="content"><p><strong>Ridge</strong> and <strong>Lasso</strong> Regressions are expansions of <strong>OLS</strong>. The <strong>key difference</strong> is that they restrict the <strong>coefficients in loss function</strong>. You may wonder why we should implement constraints and this report tries to explain the reason. Of course, there must be some problems in <strong>OLS</strong> and let’s have a look.</p>
<h2 id="Problems-of-Ordinary-Least-Squares"><a href="#Problems-of-Ordinary-Least-Squares" class="headerlink" title="Problems of Ordinary Least Squares"></a>Problems of Ordinary Least Squares</h2><p>In this report, I plan to construct a view towards it based on <strong>linear algebra</strong>. Basically, we have $Ax=b$ for $m$ equations and $n$ features and they are contained into $A$ and $b$. OLS is born to tackle the problem where we tend to give the appropriate solution but we ‘cannot solve it’. Said another way, what can we do if $A$ is <strong>singular</strong> ($b$ is <strong>out of</strong> the column space $C(A)$)? And this situation is quite often when $m\ne n$. We can show it in the figure 1 where the line is the column space consisting of all the <strong>linear combinations of $a$ (basis)</strong>.</p>
<div align=center>
    <img src = 'https://i.loli.net/2021/05/08/anohKl2A759L3FB.png' style='zoom:50%' alt='Fig1: Out of Col Space'>
</div>

<p>However, if we were forced to get the solution, we can only get the <strong>closest</strong> one. And that’s what <strong>regression</strong> typically does. We should select $v_1$ instead of any others, like $v_2$, because $e_1$ is the <strong>shortest</strong> segment, which puts $v_1$ where it is. Based on the <strong>perpendicular condition</strong>, we get,</p>
<script type="math/tex; mode=display">
v_1 = ax, \text{for }v_1//a\\
a^T(b-ax) = 0, \text{for }a\perp e_1\\
\Rightarrow a^Tax=a^Tb\\
\Rightarrow x = (a^Ta)^{-1}a^Tb</script><p>, where $x$ is the coefficient of $a$ and it is the solution. Of course, the process can be applied in the higher-dimensional cases. It is the perpendicular property (uncorrelated) that makes the OLS estimator <strong>unbiased</strong>. However, the crucial part is that we require $a^Ta$ is <strong>invertible</strong>! Note that $Rank(a^Ta)=Rank(a)$. Therefore, we will easily proceed further, which is $a$ should have a <strong>full column rank</strong>.</p>
<p>When the requirement is not satisfied (a <strong>ill-conditioned $A$</strong>), there are two probabilities,</p>
<ul>
<li>$m\ge n$, but <strong>linearly dependent vectors</strong> (Or highly correlated ones) ‘decrease’ the rank. </li>
<li>$m&lt;n$. Some vectors <strong>must be linearly dependent</strong>.</li>
</ul>
<p>Thus, we need <strong>Ridge regression</strong> and <strong>Lasso regression</strong> to solve the multi-collinearity problem. And let’s see how.</p>
<h2 id="Ridge-Regression"><a href="#Ridge-Regression" class="headerlink" title="Ridge Regression"></a>Ridge Regression</h2><h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><p>Ridge regression solve the method by building a ‘ridge’, which is <strong>adding $\lambda I$ ($\lambda&gt;0$) onto the $A^TA$</strong>. Say, if a full rank matrix is plus in, then the matrix $A^TA$ will also be <strong>nonsingular</strong>. Now, the solution to $x$ is,</p>
<script type="math/tex; mode=display">
x = (A^TA+\lambda I)^{-1}A^Tb</script><p>Like real numbers, <strong>an adding term makes the inverse a smaller multiplier</strong>. As a result, $x$ will become smaller. For simplicity, suppose $A$ is an orthogonal matrix. Say, $A^TA=I$. Then, $x_{OLS}=(A^TA)^{-1}A^Tb=A^Tb$,</p>
<script type="math/tex; mode=display">
x_{Ridge} = (I+\lambda I)^{-1}x_{OLS}=\frac{x_{OLS}}{1+\lambda}</script><p>Thus, you can clearly notice that ridge regression is a <strong>shrink</strong> on OLS estimator but how to imagine it intuitively and what about a common case? After simple transposition in dimension one, we get,</p>
<script type="math/tex; mode=display">
a^T(b-ax)=\lambda x</script><p>,so the perpendicular condition is <strong>not satisfied</strong>. As a not surprising result, the answer is <strong>not closest</strong> any more, which leads it as a <strong>biased</strong> estimator. We can draw the Fig2, </p>
<div align=center>
    <img src = 'https://i.loli.net/2021/05/08/VwlRpYHB8hKPGtv.png' style='zoom:50%' alt='Fig2: Ridge'>
</div>

<p>Since that we will have $ax_r+pa=x_{OLS}$ (where $x_r$ is the ridge estimator) in the figure, if we go deeper for the details,</p>
<script type="math/tex; mode=display">
\begin{aligned}
a^T(b-ax_r) &= \lambda x_r\\
||a||*||b-ax_r||*\cos \theta &=\lambda x_r\\
p*||a||^2 &= \lambda x_r\\
p &= \frac{\lambda x_r}{||a||^2}\\
\Rightarrow ax_r+ap &= ax_{OLS}\\
\Rightarrow x_r + \frac{\lambda x_r}{||a||^2}&=x_{OLS}\\
\Rightarrow x_r &= \frac{x_{OLS}}{1+\frac{\lambda}{||a||^2}}
\end{aligned}</script><p>Note that the brown dashed segment is $b-ax$ and $x_r$ denotes the ridge estimator. As you can see, orthogonal cases is special one because $a$ is in a unit length.</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>Insight Ridge and Lasso</p><p><a href="http://example.com/2021/05/07/Report-Ridge-Lasso/">http://example.com/2021/05/07/Report-Ridge-Lasso/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>作者</h6><p>Junwei Lin</p></div></div><div class="level-item is-narrow"><div><h6>发布于</h6><p>2021-05-07</p></div></div><div class="level-item is-narrow"><div><h6>更新于</h6><p>2021-05-09</p></div></div><div class="level-item is-narrow"><div><h6>许可协议</h6><p><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a class="icon" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a><a class="icon" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E5%BE%AE%E8%A7%82%E8%AE%A1%E9%87%8F/">微观计量</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/05/04/Challenge-Ordered-Logit/"><span class="level-item">Challenge: Ordered Logit</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1 is-sticky"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://i.loli.net/2021/04/01/s3S5IyEexAjClVm.png" alt="Chizuru7"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Chizuru7</p><p class="is-size-6 is-block">A Senior in XMU</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>Earth, Solar System</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">5</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">1</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Chizuru7"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Mail" href="mailto:362296573@qq.com"><i class="fas fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Steam" href="https://s.team/p/cfhj-vnmw/QDPBQJDG"><i class="fab fa-steam"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">目录</h3><ul class="menu-list"><li><a class="level is-mobile" href="#Problems-of-Ordinary-Least-Squares"><span class="level-left"><span class="level-item">1</span><span class="level-item">Problems of Ordinary Least Squares</span></span></a></li><li><a class="level is-mobile" href="#Ridge-Regression"><span class="level-left"><span class="level-item">2</span><span class="level-item">Ridge Regression</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#"><span class="level-left"><span class="level-item">2.1</span><span class="level-item"> </span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-05-07T11:06:03.000Z">2021-05-07</time></p><p class="title"><a href="/2021/05/07/Report-Ridge-Lasso/">Insight Ridge and Lasso</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/05/04/Challenge-Ordered-Logit/"><img src="/gallery/Ordered_Logit.png" alt="Challenge: Ordered Logit"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-05-04T06:56:34.000Z">2021-05-04</time></p><p class="title"><a href="/2021/05/04/Challenge-Ordered-Logit/">Challenge: Ordered Logit</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/03/31/Report-Regression-Spline/"><img src="/gallery/amiya_Splines.png" alt="Report - Regression Splines"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-03-31T09:38:41.000Z">2021-03-31</time></p><p class="title"><a href="/2021/03/31/Report-Regression-Spline/">Report - Regression Splines</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2021/03/29/VC%20Dimension/"><img src="/gallery/VCcover.jpg" alt="Report - VC Dimension"></a></figure><div class="media-content"><p class="date"><time dateTime="2021-03-28T16:00:00.000Z">2021-03-29</time></p><p class="title"><a href="/2021/03/29/VC%20Dimension/">Report - VC Dimension</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-03-20T16:00:00.000Z">2021-03-21</time></p><p class="title"><a href="/2021/03/21/Data%20Analysis%20for%20Econ%20Intro/">Data Analysis for Economics Intro</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E8%A7%82%E8%AE%A1%E9%87%8F/"><span class="tag">微观计量</span><span class="tag">5</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://i.loli.net/2021/04/03/wDoVkMUd9LFYgqA.png" alt="Chizuru7&#039;s Blog" height="28"></a><p class="is-size-7"><span>&copy; 2021 Junwei Lin</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'folded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>